<?php
//require('fpdf16/fpdf.php');
require_once('pdf.php');

class Barcode extends FPDF
{
function Printbarcode($xpos, $ypos, $code, $start='A', $end='A', $basewidth=0.15, $height=5) {
	$barChar = array (
		'0' => array (6.5, 10.4, 6.5, 10.4, 6.5, 24.3, 17.9),
		'1' => array (6.5, 10.4, 6.5, 10.4, 17.9, 24.3, 6.5),
		'2' => array (6.5, 10.0, 6.5, 24.4, 6.5, 10.0, 18.6),
		'3' => array (17.9, 24.3, 6.5, 10.4, 6.5, 10.4, 6.5),
		'4' => array (6.5, 10.4, 17.9, 10.4, 6.5, 24.3, 6.5),
		'5' => array (17.9,	10.4, 6.5, 10.4, 6.5, 24.3, 6.5),
		'6' => array (6.5, 24.3, 6.5, 10.4, 6.5, 10.4, 17.9),
		'7' => array (6.5, 24.3, 6.5, 10.4, 17.9, 10.4, 6.5),
		'8' => array (6.5, 24.3, 17.9, 10.4, 6.5, 10.4, 6.5),
		'9' => array (18.6, 10.0, 6.5, 24.4, 6.5, 10.0, 6.5),
		'$' => array (6.5, 10.0, 18.6, 24.4, 6.5, 10.0, 6.5),
		'-' => array (6.5, 10.0, 6.5, 24.4, 18.6, 10.0, 6.5),
		':' => array (16.7, 9.3, 6.5, 9.3, 16.7, 9.3, 14.7),
		'/' => array (14.7, 9.3, 16.7, 9.3, 6.5, 9.3, 16.7),
		'.' => array (13.6, 10.1, 14.9, 10.1, 17.2, 10.1, 6.5),
		'+' => array (6.5, 10.1, 17.2, 10.1, 14.9, 10.1, 13.6),
		'*' => array (6.5, 8.0, 6.5, 19.4, 6.5, 16.1, 19.6),
		'A' => array (6.5, 8.0, 19.6, 19.4, 6.5, 16.1, 6.5),
		'B' => array (6.5, 16.1, 6.5, 19.4, 6.5, 8.0, 19.6),
		'C' => array (6.5, 8.0, 6.5, 19.4, 6.5, 16.1, 19.6),
		'D' => array (6.5, 8.0, 6.5, 19.4, 19.6, 16.1, 6.5),
		'E' => array (6.5, 8.0, 6.5, 19.4, 19.6, 16.1, 6.5),
		'F' => array(6.5, 6.5, 6.5, 19.4, 19.6, 8,	19.6),
		'G'=> array(6.5, 8, 6.5, 19.4,	6.5, 16.1, 19.6),
		'H'=> array(17.9, 10.4, 6.5, 19.4, 6.5, 16.1, 6.5),
		'I'=> array(6.5, 21.3, 6.5, 19.4, 6.5, 16.1, 6.5),
		'J'=> array(6.5, 10, 6.5, 12.4, 19.6, 8, 19.6),
		'K'=> array(6.5, 10, 6.5, 8, 19.6, 16.1, 19.6),
		'L'=> array(15.9, 10, 6.5, 8, 19.6, 16.1, 6.5),
		'M'=> array(6.5, 10, 17.9, 19.4, 6.5, 16.1, 6.5),
		'N' => array (6.5, 16.1, 6.5, 19.4, 6.5, 8.0, 19.6),
		'O'=> array(6.5, 10, 6.5, 19.4,	6.5, 16.1, 19.6),
		'P'=> array(6.5, 8, 8,	19.4, 19.6,	16.1, 6.5),
		'Q'=> array(6.5, 8, 6.5, 19.4, 19.6,	16.1, 6.5),
		'R'=> array(6.5, 12.4, 8, 8, 6.5,	8, 19.6),
		'S'=> array(6.5, 10.4, 6.5,	19.4, 6.5, 16.1, 19.6),
		'T' => array (6.5, 8.0, 19.6, 19.4, 6.5, 16.1, 6.5),
		'U'=> array(17.9, 10.4,	6.5, 19.4, 6.5,	16.1, 6.5),
		'V'=> array(6.5, 16.1, 6.5,	8, 19.6,	8, 19.6),
		'W'=> array(6.5, 8,	6.5, 8, 19.6, 16.1, 19.6),
		'X'=> array(6.5, 8,	17.9, 8,	19.6, 16.1,	6.5),
		'Y'=> array(12, 16.1, 6.5,	19.4, 6.5, 16.1, 6.5),
		'Z'=> array(10, 10, 10,	19.4, 6.5, 8, 19.6),
	);
	$this->SetFont('Arial','',4);
	$this->Text($xpos, $ypos + $height + 1.7 , $code);
	$this->SetFillColor(0);
	$code = strtoupper($start.$code.$end);
	for($i=0; $i<strlen($code); $i++){
		$char = $code[$i];
		if(!isset($barChar[$char])){
			$this->Error('Invalid character in barcode: '.$char);
		}
		$seq = $barChar[$char];
		for($bar=0; $bar<7; $bar++){
			$lineWidth = $basewidth*$seq[$bar]/6.5;
			if($bar % 2 == 0){
				$this->Rect($xpos, $ypos, $lineWidth, $height, 'F');
			}
			$xpos += $lineWidth;
		}
		$xpos += $basewidth*10.4/6.5;
	}
}
}
?>
